{% extends "student/refunds/base_refund.html" %}

{% block refund_content %}
<div class="max-w-6xl mx-auto mb-24">
    <div class="bg-white rounded-lg shadow-sm hover:shadow-md transition-all duration-300 border border-rose-100 p-6 mb-6 animate-[fadeInUp_0.6s_ease-out]">
        <h2 class="text-2xl font-bold text-rose-700/80 mb-4">
            {% if LANGUAGE_CODE == 'ar' %}
            المرفقات - {{ dispute.title }}
            {% else %}
            Attachments - {{ dispute.title }}
            {% endif %}
        </h2>

        <!-- Upload Form -->
        <div class="mb-8 p-4 bg-rose-50/50 rounded-lg border border-rose-100">
            <h3 class="text-lg font-medium text-rose-700/80 mb-3">
                {% if LANGUAGE_CODE == 'ar' %}
                إضافة مرفق جديد
                {% else %}
                Add New Attachment
                {% endif %}
            </h3>
            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    {% for field in form %}
                    <div class="mb-3">
                        <label class="block text-sm font-medium text-gray-700 mb-1">{{ field.label }}</label>
                        {{ field }}
                        {% if field.errors %}
                        <p class="mt-1 text-sm text-red-600">{{ field.errors.0 }}</p>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>
                <button type="submit"
                        class="mt-3 px-4 py-2 bg-rose-600 text-white rounded-md hover:bg-rose-700 transition">
                    {% if LANGUAGE_CODE == 'ar' %}
                    رفع الملف
                    {% else %}
                    Upload File
                    {% endif %}
                </button>
            </form>
        </div>

        <!-- Attachments List -->
        <div>
            <h3 class="text-lg font-medium text-rose-700/80 mb-3">
                {% if LANGUAGE_CODE == 'ar' %}
                المرفقات الحالية
                {% else %}
                Current Attachments
                {% endif %}
            </h3>

            {% if attachments %}
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                {% for attachment in attachments %}
                <div class="border border-rose-100 rounded-lg p-3 hover:shadow-md transition">
                    <div class="flex items-start space-x-3">
                        <div class="flex-shrink-0 text-rose-500">
                            {% if attachment.file_type == 'image' %}
                            <i class="fas fa-image text-2xl"></i>
                            {% elif attachment.file_type == 'document' %}
                            <i class="fas fa-file-alt text-2xl"></i>
                            {% else %}
                            <i class="fas fa-paperclip text-2xl"></i>
                            {% endif %}
                        </div>
                        <div class="flex-grow">
                            <h4 class="font-medium text-gray-800">{{ attachment.description|default:"No description" }}</h4>
                            <p class="text-sm text-gray-500">{{ attachment.file.name|slice:"25:" }}</p>
                            <div class="mt-2 flex space-x-2">
                                <a href="{{ attachment.file.url }}"
                                   target="_blank"
                                   class="text-sm text-rose-600 hover:text-rose-800">
                                    {% if LANGUAGE_CODE == 'ar' %}
                                    عرض
                                    {% else %}
                                    View
                                    {% endif %}
                                </a>
                                <span class="text-gray-300">|</span>
                                <a href="{{ attachment.file.url }}"
                                   download
                                   class="text-sm text-rose-600 hover:text-rose-800">
                                    {% if LANGUAGE_CODE == 'ar' %}
                                    تحميل
                                    {% else %}
                                    Download
                                    {% endif %}
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <p class="text-gray-500 italic py-4">
                {% if LANGUAGE_CODE == 'ar' %}
                لا توجد مرفقات حتى الآن
                {% else %}
                No attachments yet
                {% endif %}
            </p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}