{% extends "base_student_dashboard.html" %}
{% load static %}
{% block content %}
<main class="w-full bg-gradient-to-br from-rose-50 to-amber-50 text-[1.125rem] leading-relaxed text-gray-800">
  <!-- Full viewport image with gradient overlay -->
  <div class="relative w-full  h-[60vh] md:h-[50vh]">
    <img
            src="{% if article.img %}{{ article.img.url }}{% else %}{% static 'images/unnamed.png' %}{% endif %}"
            alt="{{ article.title }}"
            class="w-full h-full object-cover object-center"
    />

    <div class="absolute bottom-0 left-0 right-0 p-8 text-white animate-[fadeInUp_0.6s_ease-out]">
      <h1 class="text-4xl md:text-5xl font-extrabold mb-4 text-right">
        ✨ {{ article.title }}
      </h1>
      <div class="text-right">
        <span class="text-sm opacity-90">{% if LANGUAGE_CODE == 'ar' %}
          📅 تاريخ النشر:
        {% else %}
          📅 Published on:
        {% endif %} {{ article.creation_date|date:"d/m/Y" }}</span>
      </div>
    </div>
  </div>

  <!-- Article content -->
  <div class="relative py-16 bg-gradient-to-b from-white via-rose-50/30 to-amber-50/20">
    <!-- Decorative background elements -->
    <div class="absolute inset-0 overflow-hidden pointer-events-none">
      <div class="absolute top-20 right-10 w-32 h-32 bg-rose-200/20 rounded-full blur-3xl"></div>
      <div class="absolute bottom-40 left-10 w-40 h-40 bg-amber-200/20 rounded-full blur-3xl"></div>
      <div class="absolute top-60 left-1/2 w-24 h-24 bg-purple-200/20 rounded-full blur-2xl"></div>
    </div>

    <div class="max-w-6xl mx-auto px-4 relative z-10">
      <!-- Article metadata bar -->
      <div class="mb-8 p-4 bg-white/80 backdrop-blur-sm rounded-2xl shadow-sm border border-rose-100/50 animate-[fadeIn_0.8s_ease-out_0.1s_both]">
        <div class="flex items-center justify-between text-sm text-gray-600">
          <div class="flex items-center gap-4">
          <span class="flex items-center gap-1">
            <svg class="w-4 h-4 text-rose-500" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"/>
            </svg>
            <span>{{ article.read_time|default:"5 دقائق" }} {% if LANGUAGE_CODE == 'ar' %}قراءة{% else %}min read{% endif %}</span>
          </span>
            <span class="flex items-center gap-1">
            <svg class="w-4 h-4 text-amber-500" fill="currentColor" viewBox="0 0 20 20">
              <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
            </svg>
            <span>{% if LANGUAGE_CODE == 'ar' %}مقال مميز{% else %}Featured{% endif %}</span>
          </span>
          </div>
        </div>
      </div>

      <!-- Main article content with enhanced styling -->
      <div class="bg-white/90 backdrop-blur-sm rounded-3xl shadow-lg border border-rose-100/50 overflow-hidden animate-[fadeIn_0.8s_ease-out_0.2s_both]">
        <!-- Content header -->
        <div class="p-8 pb-6 border-b border-rose-100/50">
          <div class="flex items-center gap-3 mb-4">
            <div class="w-1 h-8 bg-gradient-to-b from-rose-400 to-amber-400 rounded-full"></div>
            <span class="text-sm font-medium text-rose-600 uppercase tracking-wider">
            {% if LANGUAGE_CODE == 'ar' %}محتوى المقال{% else %}Article Content{% endif %}
          </span>
          </div>
        </div>

        <!-- Enhanced article body -->
        <div class="p-8 pt-6">
          <div class="prose prose-lg max-w-none text-right
                    prose-headings:text-gray-800 prose-headings:font-bold
                    prose-h2:text-2xl prose-h2:mb-4 prose-h2:mt-8 prose-h2:text-rose-700
                    prose-h3:text-xl prose-h3:mb-3 prose-h3:mt-6 prose-h3:text-rose-600
                    prose-p:text-gray-700 prose-p:leading-relaxed prose-p:mb-6
                    prose-strong:text-gray-900 prose-strong:font-semibold
                    prose-em:text-rose-700 prose-em:not-italic prose-em:font-medium
                    prose-a:text-rose-600 prose-a:no-underline hover:prose-a:text-rose-700 hover:prose-a:underline
                    prose-blockquote:border-r-4 prose-blockquote:border-rose-300 prose-blockquote:bg-rose-50/50
                    prose-blockquote:p-4 prose-blockquote:rounded-lg prose-blockquote:not-italic prose-blockquote:text-gray-700
                    prose-ul:text-gray-700 prose-ol:text-gray-700
                    prose-li:mb-2 prose-li:leading-relaxed
                    prose-code:bg-gray-100 prose-code:px-2 prose-code:py-1 prose-code:rounded prose-code:text-sm
                    prose-pre:bg-gray-50 prose-pre:border prose-pre:border-gray-200 prose-pre:rounded-lg">

            {{ article.body|safe }}

          </div>
        </div>

        <!-- Article footer with tags and actions -->
        <div class="px-8 pb-8">
          <div class="border-t border-rose-100/50 pt-6">
            <!-- Tags section -->
            {% if article.tags.all %}
            <div class="mb-6">
              <h4 class="text-sm font-medium text-gray-600 mb-3 text-right">
                {% if LANGUAGE_CODE == 'ar' %}العلامات:{% else %}Tags:{% endif %}
              </h4>
              <div class="flex flex-wrap gap-2 justify-end">
                {% for tag in article.tags.all %}
                <span class="px-3 py-1 bg-rose-100 text-rose-700 rounded-full text-sm font-medium hover:bg-rose-200 transition-colors duration-200">
                #{{ tag.name }}
              </span>
                {% endfor %}
              </div>
            </div>
            {% endif %}

            <!-- Action buttons -->
            <div class="flex items-center justify-between">

              <div class="text-sm text-gray-500 text-right">
                <span>{% if LANGUAGE_CODE == 'ar' %}تم النشر:{% else %}Last updated:{% endif %}</span>
                <span class="font-medium">{{ article.updated_date|date:"d/m/Y"|default:article.creation_date|date:"d/m/Y" }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Progress indicator -->
      <div class="fixed top-0 left-0 w-full h-1 bg-gray-200 z-50">
        <div class="h-full bg-gradient-to-r from-rose-400 to-amber-400 transition-all duration-300" style="width: 0%" id="reading-progress"></div>
      </div>
    </div>
  </div>

  <!-- Related Articles -->
  <div class="py-12 mb-24 container mx-auto px-4">
    <div class="max-w-5xl mx-auto">
      <h2 class="text-3xl font-bold mb-8 text-right text-rose-700/80 animate-[fadeIn_0.8s_ease-out_0.3s_both]">
        {% if LANGUAGE_CODE == 'ar' %}
        💖 مواضيع قد تهمّك
        {% else %}
        💖 Related Topics
        {% endif %}
      </h2>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        {% for related in related_articles %}
        <div class="animate-[fadeInUp_0.6s_ease-out_{{ forloop.counter|add:0.4 }}s_both] bg-white rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-all duration-300 border border-rose-100">
          <img
                  src="{% if related.img %}{{ related.img.url }}{% else %}{% static 'images/unnamed.png' %}{% endif %}"
                  alt="{{ related.title }}"
                  class="w-full h-48 object-cover object-center"
          />
          <div class="p-6">
            <h3 class="text-xl font-semibold mb-2 text-right text-rose-700/80">
              {{ related.title }}
            </h3>
            <p class="text-gray-700 text-base mb-4 text-right leading-relaxed line-clamp-3">
              {{ related.desc }}
            </p>
            <a
                    href="{% url 'viewArticle' related.id %}"
                    class="rounded-lg bg-rose-400/90 text-white px-4 py-2 hover:bg-rose-600/90 transition-all duration-300 inline-block float-right"
            >
              {% if LANGUAGE_CODE == 'ar' %}
              📖 قراءة المزيد
              {% else %}
              📖 Read More
              {% endif %}
            </a>
          </div>
        </div>
        {% empty %}
        <div class="col-span-3 animate-[fadeIn_0.8s_ease-out_0.4s_both] bg-white rounded-lg shadow-sm hover:shadow-md transition-all duration-300 border border-rose-100 p-12 text-center">
          <div class="text-2xl font-semibold text-rose-400/80">
            {% if LANGUAGE_CODE == 'ar' %}
            🙁 لا توجد مقالات ذات صلة
            {% else %}
            🙁 No related articles available
            {% endif %}
          </div>
          <p class="text-gray-500 mt-2">
            {% if LANGUAGE_CODE == 'ar' %}
            يمكنك تصفح المزيد من المقالات في صفحة المدونة
            {% else %}
            You can browse more articles on the blog page
            {% endif %}
          </p>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>
</main>
<script>
  // Reading progress indicator
  window.addEventListener('scroll', () => {
    const article = document.querySelector('.prose');
    if (article) {
      const articleTop = article.offsetTop;
      const articleHeight = article.offsetHeight;
      const windowHeight = window.innerHeight;
      const scrollTop = window.pageYOffset;

      const progress = Math.min(100, Math.max(0,
        ((scrollTop - articleTop + windowHeight) / articleHeight) * 100
      ));

      document.getElementById('reading-progress').style.width = progress + '%';
    }
  });

  // Interactive buttons
  document.addEventListener('DOMContentLoaded', function() {
    // Like button functionality
    const likeBtn = document.querySelector('button:has(svg path[d*="4.318"])');
    if (likeBtn) {
      likeBtn.addEventListener('click', function() {
        this.classList.toggle('bg-rose-500');
        this.classList.toggle('text-white');
        this.classList.toggle('bg-rose-100');
        this.classList.toggle('text-rose-700');
      });
    }

    // Save button functionality
    const saveBtn = document.querySelector('button:has(svg path[d*="5 5"])');
    if (saveBtn) {
      saveBtn.addEventListener('click', function() {
        this.classList.toggle('bg-amber-500');
        this.classList.toggle('text-white');
        this.classList.toggle('bg-amber-100');
        this.classList.toggle('text-amber-700');
      });
    }
  });
</script>
<style>
  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes fadeInDown {
    from {
      opacity: 0;
      transform: translateY(-20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes fadeInRight {
    from {
      opacity: 0;
      transform: translateX(20px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  .prose p {
    font-size: 1.125rem;
    line-height: 1.75rem;
  }

  .prose h1, .prose h2, .prose h3 {
    font-weight: 700;
    color: #1f2937;
  }

  .prose img {
    border-radius: 0.5rem;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }
</style>
{% endblock %}
