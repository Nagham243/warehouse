{% extends "base_club_dashboard.html" %}
{% load static %}

{% block content %}
<style>
    /* Animation Classes */
    .animate-float {
        animation: float 4s ease-in-out infinite;
    }

    .animate-fadeIn {
        animation: fadeIn 0.6s ease-out forwards;
        opacity: 0;
    }

    .animate-fadeInUp {
        animation: fadeInUp 0.8s ease-out forwards;
        opacity: 0;
    }

    .animate-stagger > * {
        animation: fadeInUp 0.6s ease-out forwards;
        opacity: 0;
    }

    .animate-stagger > *:nth-child(1) { animation-delay: 0.1s; }
    .animate-stagger > *:nth-child(2) { animation-delay: 0.2s; }
    .animate-stagger > *:nth-child(3) { animation-delay: 0.3s; }

    /* Button Effects */
    .btn-gradient {
        background-size: 200% auto;
        transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    }

    .btn-gradient:hover {
        background-position: right center;
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
    }

    /* Keyframes */
    @keyframes float {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-8px); }
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateX(10px); }
        to { opacity: 1; transform: translateX(0); }
    }

    @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }

    /* Background Animation */
    .animated-bg {
        animation: gradientBG 15s ease infinite;
        background-size: 300% 300%;
    }

    @keyframes gradientBG {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
    }

    /* File Upload Styles */
    .file-upload-area {
        border: 2px dashed #cbd5e0;
        transition: all 0.3s ease;
    }

    .file-upload-area:hover {
        border-color: #3182ce;
        background-color: #ebf8ff;
    }

    .file-upload-area.dragover {
        border-color: #3182ce;
        background-color: #ebf8ff;
        transform: scale(1.02);
    }
</style>

<div class="{% if LANGUAGE_CODE == 'ar' %}xl:pr-[20%]{% else %}xl:pl-[20%]{% endif %} animated-bg bg-gradient-to-br from-blue-50 to-purple-50 w-full px-4 md:px-8 min-h-screen pb-12 pt-8 font-sans">

    <!-- Header Section -->
    <div class="flex flex-col md:flex-row justify-between items-center mb-8 gap-4 animate-fadeIn">
        <div class="flex items-center space-x-4 space-x-reverse">
            <div class="p-3 rounded-full bg-green-100 text-green-600 animate-float">
                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"/>
                </svg>
            </div>
            <div>
                <h1 class="text-3xl font-bold text-gray-800">
                    {% if LANGUAGE_CODE == 'ar' %}استيراد العملاء{% else %}Import Clients{% endif %}
                </h1>
                <p class="text-gray-600">
                    {% if LANGUAGE_CODE == 'ar' %}
                    استيراد عدة عملاء من ملف Excel أو CSV
                    {% else %}
                    Import multiple clients from Excel or CSV file
                    {% endif %}
                </p>
            </div>
        </div>

        <a href="{% url 'viewStudents' %}"
           class="btn-gradient bg-gradient-to-r from-gray-500 to-gray-600 text-white px-6 py-3 rounded-lg shadow-md flex items-center gap-2 hover:gap-3 transition-all duration-300">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m0 7h18"/>
            </svg>
            {% if LANGUAGE_CODE == 'ar' %}رجوع للقائمة{% else %}Back to List{% endif %}
        </a>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">

        <!-- Import Form -->
        <div class="bg-white rounded-xl shadow-lg p-8 border border-gray-100 animate-fadeInUp">
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-2">
                    {% if LANGUAGE_CODE == 'ar' %}رفع الملف{% else %}Upload File{% endif %}
                </h2>
                <p class="text-gray-600">
                    {% if LANGUAGE_CODE == 'ar' %}
                    اختر ملف Excel أو CSV يحتوي على بيانات العملاء
                    {% else %}
                    Select an Excel or CSV file containing client data
                    {% endif %}
                </p>
            </div>

            <form method="post" enctype="multipart/form-data" action="{% url 'process_import_students' %}" class="animate-stagger">
                {% csrf_token %}

                <!-- File Upload Area -->
                <div class="file-upload-area rounded-lg p-8 text-center mb-6" id="fileUploadArea">
                    <svg class="mx-auto h-12 w-12 text-gray-400 mb-4" stroke="currentColor" fill="none" viewBox="0 0 48 48">
                        <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    <div class="mb-4">
                        <label for="file-upload" class="cursor-pointer">
              <span class="text-lg font-medium text-blue-600 hover:text-blue-500">
                {% if LANGUAGE_CODE == 'ar' %}اختر ملف{% else %}Choose file{% endif %}
              </span>
                            <input id="file-upload" name="file" type="file" accept=".xlsx,.xls,.csv" class="sr-only" required>
                        </label>
                        <p class="text-gray-500 mt-2">
                            {% if LANGUAGE_CODE == 'ar' %}أو اسحب الملف هنا{% else %}or drag and drop here{% endif %}
                        </p>
                    </div>
                    <p class="text-sm text-gray-500">
                        {% if LANGUAGE_CODE == 'ar' %}
                        الملفات المدعومة: Excel (.xlsx, .xls) أو CSV
                        {% else %}
                        Supported files: Excel (.xlsx, .xls) or CSV
                        {% endif %}
                    </p>
                </div>

                <!-- Selected file display -->
                <div id="selectedFile" class="hidden mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200">
                    <div class="flex items-center">
                        <svg class="w-6 h-6 text-blue-500 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                        </svg>
                        <span id="fileName" class="text-blue-700 font-medium"></span>
                    </div>
                </div>

                <!-- Submit Button -->
                <button type="submit" class="w-full btn-gradient bg-gradient-to-r from-green-500 to-green-600 text-white py-3 px-4 rounded-lg font-medium flex items-center justify-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                    </svg>
                    {% if LANGUAGE_CODE == 'ar' %}استيراد العملاء{% else %}Import Clients{% endif %}
                </button>
            </form>
        </div>

        <!-- Instructions and Template -->
        <div class="space-y-6">

            <!-- Download Template -->
            <div class="bg-white rounded-xl shadow-lg p-8 border border-gray-100 animate-fadeInUp">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">
                        {% if LANGUAGE_CODE == 'ar' %}تحميل النموذج{% else %}Download Template{% endif %}
                    </h2>
                    <p class="text-gray-600">
                        {% if LANGUAGE_CODE == 'ar' %}
                        حمل نموذج Excel لمساعدتك في تنسيق البيانات
                        {% else %}
                        Download Excel template to help you format your data
                        {% endif %}
                    </p>
                </div>

                <a href="{% url 'download_sample_template' %}"
                   class="w-full btn-gradient bg-gradient-to-r from-blue-500 to-blue-600 text-white py-3 px-4 rounded-lg font-medium flex items-center justify-center gap-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                    </svg>
                    {% if LANGUAGE_CODE == 'ar' %}تحميل النموذج{% else %}Download Template{% endif %}
                </a>
            </div>

            <!-- Instructions -->
            <div class="bg-white rounded-xl shadow-lg p-8 border border-gray-100 animate-fadeInUp">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">
                    {% if LANGUAGE_CODE == 'ar' %}التعليمات{% else %}Instructions{% endif %}
                </h2>

                <div class="space-y-4 text-gray-600">
                    <div class="flex items-start gap-3">
                        <span class="bg-blue-100 text-blue-600 w-6 h-6 rounded-full flex items-center justify-center text-sm font-bold flex-shrink-0 mt-0.5">1</span>
                        <p>
                            {% if LANGUAGE_CODE == 'ar' %}
                            حمل النموذج وافتحه في Excel أو Google Sheets
                            {% else %}
                            Download the template and open it in Excel or Google Sheets
                            {% endif %}
                        </p>
                    </div>

                    <div class="flex items-start gap-3">
                        <span class="bg-blue-100 text-blue-600 w-6 h-6 rounded-full flex items-center justify-center text-sm font-bold flex-shrink-0 mt-0.5">2</span>
                        <p>
                            {% if LANGUAGE_CODE == 'ar' %}
                            املأ البيانات المطلوبة لكل عميل
                            {% else %}
                            Fill in the required data for each client
                            {% endif %}
                        </p>
                    </div>

                    <div class="flex items-start gap-3">
                        <span class="bg-blue-100 text-blue-600 w-6 h-6 rounded-full flex items-center justify-center text-sm font-bold flex-shrink-0 mt-0.5">3</span>
                        <p>
                            {% if LANGUAGE_CODE == 'ar' %}
                            احفظ الملف بصيغة Excel (.xlsx) أو CSV
                            {% else %}
                            Save the file as Excel (.xlsx) or CSV format
                            {% endif %}
                        </p>
                    </div>

                    <div class="flex items-start gap-3">
                        <span class="bg-blue-100 text-blue-600 w-6 h-6 rounded-full flex items-center justify-center text-sm font-bold flex-shrink-0 mt-0.5">4</span>
                        <p>
                            {% if LANGUAGE_CODE == 'ar' %}
                            ارفع الملف باستخدام النموذج أعلاه
                            {% else %}
                            Upload the file using the form above
                            {% endif %}
                        </p>
                    </div>
                </div>

                <!-- Required Fields -->
                <div class="mt-6 p-4 bg-yellow-50 rounded-lg border border-yellow-200">
                    <h3 class="font-semibold text-yellow-800 mb-2">
                        {% if LANGUAGE_CODE == 'ar' %}الحقول المطلوبة:{% else %}Required Fields:{% endif %}
                    </h3>
                    <ul class="text-sm text-yellow-700 space-y-1">
                        <li>• username ({% if LANGUAGE_CODE == 'ar' %}اسم المستخدم{% else %}unique username{% endif %})</li>
                        <li>• email ({% if LANGUAGE_CODE == 'ar' %}البريد الإلكتروني{% else %}unique email{% endif %})</li>
                        <li>• full_name ({% if LANGUAGE_CODE == 'ar' %}الاسم الكامل{% else %}full name{% endif %})</li>
                        <li>• phone ({% if LANGUAGE_CODE == 'ar' %}رقم الهاتف{% else %}phone number{% endif %})</li>
                        <li>• birthday ({% if LANGUAGE_CODE == 'ar' %}تاريخ الميلاد (YYYY-MM-DD){% else %}birthday (YYYY-MM-DD){% endif %})</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // File upload functionality
    const fileUploadArea = document.getElementById('fileUploadArea');
    const fileInput = document.getElementById('file-upload');
    const selectedFileDiv = document.getElementById('selectedFile');
    const fileNameSpan = document.getElementById('fileName');

    // Handle file selection
    fileInput.addEventListener('change', function(e) {
      const file = e.target.files[0];
      if (file) {
        fileNameSpan.textContent = file.name;
        selectedFileDiv.classList.remove('hidden');
      }
    });

    // Drag and drop functionality
    fileUploadArea.addEventListener('dragover', function(e) {
      e.preventDefault();
      fileUploadArea.classList.add('dragover');
    });

    fileUploadArea.addEventListener('dragleave', function(e) {
      e.preventDefault();
      fileUploadArea.classList.remove('dragover');
    });

    fileUploadArea.addEventListener('drop', function(e) {
      e.preventDefault();
      fileUploadArea.classList.remove('dragover');

      const files = e.dataTransfer.files;
      if (files.length > 0) {
        const file = files[0];
        if (file.name.match(/\.(xlsx|xls|csv)$/)) {
          fileInput.files = files;
          fileNameSpan.textContent = file.name;
          selectedFileDiv.classList.remove('hidden');
        } else {
          alert('{% if LANGUAGE_CODE == 'ar' %}يرجى رفع ملف Excel أو CSV فقط{% else %}Please upload only Excel or CSV files{% endif %}');
        }
      }
    });

    // Click to upload
    fileUploadArea.addEventListener('click', function() {
      fileInput.click();
    });
</script>
{% endblock %}